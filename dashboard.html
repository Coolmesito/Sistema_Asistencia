<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Sistema | Dashboard</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

</head>

<body>
    <div id="wrapper">
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav metismenu" id="side-menu">
                    <li class="nav-header" >
                        <div class="dropdown profile-element">
                            <img alt="image" class="rounded-circle" src="img/profile_small.jpg"/>
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="block m-t-xs font-bold">Marlo Samaniego Calderon</span>
                                <span class="text-muted text-xs block">Administrador <b class="caret"></b></span>
                            </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                <li><a class="dropdown-item" href="perfil.html">Perfil</a></li>
                            </ul>
                        </div>
                        <div class="logo-element">
                            <img alt="image" class="rounded-circle" src="img/profile_small.jpg"/>
                        </div>
                    </li>
                    <li class="" >
                        <a href="dashboard.html"><i class="fa fa-th-large"></i> <span class="nav-label">Inicio</span></a>
                    </li>
                    <li>
                        <a href="usuarios.html"><i class="fa fa-user-circle" style="color: white;"></i> <span class="nav-label" style="color: white;">Usuarios</span></a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-calendar-o"></i> <span class="nav-label">Horarios</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                            <li><a href="horario-presencial.html">Horario Presencial</a></li>
                            <li><a href="horario-virtual.html">Horario Virtual</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="asistencia-areas.html"><i class="fa fa-newspaper-o"></i> <span class="nav-label">Asistencia </span><span class="label label-warning float-right">16/24</span></a>
                    </li>
                    <li>
                        <a href="colaboradores.html"><i class="fa fa-group"></i> <span class="nav-label">Colaboradores</span></a>
                    </li>
                    <li>
                        <a href="reportes.html"><i class="fa fa-files-o"></i> <span class="nav-label">Reportes</span></a>
                    </li> 
                    <li>
                        <a href="areas.html"><i class="fa fa-pie-chart"></i> <span class="nav-label">√Åreas</span>  </a>
                    </li> 
                    <li>
                        <a href="maquinas.html"><i class="fa fa-laptop" style="color: white;"></i> <span class="nav-label" style="color: white;">M√°quinas</span></a>
                    </li>
                </ul>
            </div>
        </nav>
        <div id="page-wrapper" class="gray-bg">
            <div class="row border-bottom">
            <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0; background-color: #147889;">
            <div class="navbar-header">
                <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
            </div>
                <ul class="nav navbar-top-links navbar-right">
                    <li class="dropdown">
                        <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                            <i class="fa fa-bell"  style="color: white;"></i> <span class="label label-primary">4</span>
                        </a>
                        <ul class="dropdown-menu dropdown-alerts">
                            <li>
                                <a href="mailbox.html" class="dropdown-item">
                                    <div>
                                        <i class="fa fa-envelope fa-fw"></i> Tiene 4 mensajes.
                                        <span class="float-right text-muted small">4 minutes ago</span>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown-toggle count-info">
                        <a href="configuracion.html">
                            <i class="fa fa-cog" style="color: white;"></i>
                        </a>                    
                    </li>
                    <li>
                        <a href="login.html">
                            <i class="fa fa-sign-out"  style="color: white;"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    
         <!--PARTE DEL DASHBOARD (CUADROS)-->
            <div class="wrapper wrapper-content">

                <!-- SOBRE EL CHATBOT -->
                <button id="chatToggle" class="chat-btn">
                    <i class="fa fa-comments"></i>
                </button>
                <div id="chatBox" class="chat-box">
                    <div class="chat-header">
                        <strong>AsisBot ü§ñ</strong>
                        <button id="closeChat" class="close-btn">&times;</button>
                    </div>
                    <div class="chat-body" id="chatBody">
                        <div class="bot-message">¬°Hola! ¬øEn qu√© puedo ayudarte hoy?</div>
                    </div>
                    <div class="chat-footer">
                        <input type="text" id="chatInput" class="form-control" placeholder="Escribe algo...">
                        <button class="btn btn-success btn-sm" onclick="sendMessage()">Enviar</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-success float-right">Total</span>
                                <h5>Usuarios</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">2</h1>
                                <small>Han ingresado</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-info float-right">Trabajando</span>
                                <h5>√Åreas</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">3</h1>
                                <small>En este momento</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-primary float-right"> Ahora</span>
                                <h5>Asistencia</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">7</h1>
                                <small>Hasta el momento</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-primary float-right">Hoy</span>
                                <h5>Colaboradores</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">14</h1>
                                <small>N√∫mero total</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox ">
                            <div class="ibox-title"><h5>Asistencia Mensual</h5></div>
                            <div class="ibox-content">
                                <div class="row">
                                <div class="col-lg-12">
                                    <div class="flot-chart">
                                        <div class="flot-chart-content" id="flot-dashboard-chart"></div>
                                    </div>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!-- Gr√°fico de l√≠neas -->
                    <div class="col-lg-8">
                        <div class="ibox">
                            <div class="ibox-title">
                                <h5>Asistencia Semanal</h5>
                            </div>
                            <div class="ibox-content">
                                <canvas id="lineChart" height="114"></canvas>
                            </div>
                        </div>
                    </div>
                    <!-- Gr√°fico de dona -->
                    <div class="col-lg-4">
                        <div class="ibox">
                            <div class="ibox-title">
                                <h5>Asistencia Diaria</h5>
                            </div>
                            <div class="ibox-content">
                                <canvas id="doughnutChart2" width="80" height="64" style="margin: 18px auto 0"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <div class="float-right">Redes <strong>Sociales</strong> Free.</div>
                <div><strong>Copyright</strong>  JyP Perifericos &copy; 2025-2030</div>
            </div>
        </div>
    </div>
</div>

    <!-- Mainly scripts -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Flot -->
    <script src="js/plugins/flot/jquery.flot.js"></script>
    <script src="js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="js/plugins/flot/jquery.flot.spline.js"></script>
    <script src="js/plugins/flot/jquery.flot.resize.js"></script>
    <script src="js/plugins/flot/jquery.flot.pie.js"></script>
    <script src="js/plugins/flot/jquery.flot.symbol.js"></script>
    <script src="js/plugins/flot/jquery.flot.time.js"></script>

    <!-- Peity -->
    <script src="js/plugins/peity/jquery.peity.min.js"></script>
    <script src="js/demo/peity-demo.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/inspinia.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>

    <!-- jQuery UI -->
    <script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <!-- Jvectormap -->
    <script src="js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
    <script src="js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

    <!-- EayPIE -->
    <script src="js/plugins/easypiechart/jquery.easypiechart.js"></script>

    <!-- Sparkline -->
    <script src="js/plugins/sparkline/jquery.sparkline.min.js"></script>

    <!-- Sparkline demo data  -->
    <script src="js/demo/sparkline-demo.js"></script>

    <!-- ChartJS-->
    <script src="js/plugins/chartJs/Chart.min.js"></script>
    
    <style>
        /* OCULTANDO LO DE ORGANIZAR*/
            /* Ver (n√∫meros) */
            div.dataTables_length {
                display: none;
            }
    
            /* El Buscar */
            div.dataTables_filter {
                display: none;
            }
    
            /* CSV, Excel, PDF, Print */
            div.dt-buttons {
                display: none;
            }
    
        /* LAYOUT*/
        /* Men√∫ lateral */
        .navbar-static-side {
            background-color: #0F172A; /* Azul m√°s oscuro */
        }
        /* Enlaces del men√∫ */
        .nav > li > a {
            color: #CBD5E1; /* Color de texto */
            padding: 15px 20px;
            display: block;
        }
        /* Submen√∫s */
        .nav ul {
            background-color: #0F172A !important; /* Mantiene el color de fondo de submen√∫s */
            padding-left: 0;
        }
        /* Mantiene el color del submen√∫, excepto para el Administrador */
        .nav ul {
            background-color: #0F172A !important; /* Azul oscuro */
            padding-left: 0;
        }
        /* Excepci√≥n: No aplica al ul dentro del perfil del Administrador */
        .nav-header ul {
            background-color: white !important;
        }
    
    /* Excepci√≥n: No aplica al dropdown de notificaciones */
    .dropdown-menu.dropdown-alerts {
        background-color: white !important; /* Fondo blanco */
        color: black !important;
        border: 1px solid #ddd; /* Opcional: Borde sutil */
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* Sombra para resaltar */
    }
    
    /* Ajusta los √≠tems dentro del dropdown */
    .dropdown-menu.dropdown-alerts li a {
        color: black !important;
    }
    
    /* Cambia el hover dentro del dropdown */
    .dropdown-menu.dropdown-alerts li a:hover {
        background-color: #f8f9fa !important; /* Un gris claro en hover */
    }
    
    /**TODO SOBRE LE CHATBOR*/   
    .chat-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;
    background-color: #1ab394;
    color: white;
    border: none;
    border-radius: 50%;
    width: 55px;
    height: 55px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    font-size: 22px;
    cursor: pointer;
    }

    .chat-box {
        position: fixed;
        bottom: 100px;
        right: 30px;
        width: 300px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        display: none;
        flex-direction: column;
        z-index: 1000;
    }

    .chat-header {
        background: #1ab394;
        color: white;
        padding: 10px;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chat-body {
        padding: 10px;
        height: 200px;
        overflow-y: auto;
        background-color: #f9f9f9;
    }

    .chat-footer {
        padding: 10px;
        display: flex;
        gap: 5px;
    }

    .bot-message {
        background-color: #e0f7fa;
        padding: 8px 12px;
        border-radius: 10px;
        margin-bottom: 8px;
        font-size: 14px;
        width: fit-content;
        max-width: 80%;
    }

    .user-message {
        background-color: #dcedc8;
        padding: 8px 12px;
        border-radius: 10px;
        margin-bottom: 8px;
        font-size: 14px;
        width: fit-content;
        max-width: 80%;
        align-self: flex-end;
        margin-left: auto;
    }

    .close-btn {
        background: transparent;
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
    }   
    </style>

    <script>
        $(document).ready(function() {
            // Datos de asistencia mensual de hasta 50 colaboradores
            var data2 = [
                [gd(2025, 2, 1), 22], [gd(2025, 3, 1), 25], [gd(2025, 4, 1), 20],
                [gd(2025, 5, 1), 21], [gd(2025, 6, 1), 19],[gd(2025, 7, 1), 17]
            ];
    
            var dataset = [
                {
                    label: "Colaboradores",
                    data: data2,
                    color: "#1ab394",
                    bars: {
                        show: true,
                        align: "center",
                        barWidth: 24 * 60 * 60 * 600 * 32, // Ajustado para reducir la separaci√≥n
                        lineWidth: 1,
                        fillColor: "#1ab394"
                    }
                }
            ];
    
            var options = {
                xaxis: {
                    mode: "time",
                    tickSize: [1, "month"],
                    tickLength: 0,
                    axisLabel: "Fecha",
                    axisLabelUseCanvas: true,
                    axisLabelFontSizePixels: 12,
                    axisLabelFontFamily: 'Arial',
                    axisLabelPadding: 10,
                    color: "#d5d5d5"
                },
                yaxis: {
                    min: 0,
                    max: 50,
                    tickSize: 5,
                    color: "#d5d5d5",
                    axisLabel: "N√∫mero de Asistentes",
                    axisLabelUseCanvas: true,
                    axisLabelFontSizePixels: 12,
                    axisLabelFontFamily: 'Arial',
                    axisLabelPadding: 3
                },
                legend: {
                    noColumns: 1,
                    labelBoxBorderColor: "#000000",
                    position: "nw"
                },
                grid: {
                    hoverable: true,
                    borderWidth: 1,
                    borderColor: "#d5d5d5"
                },
                tooltip: true,
                tooltipOpts: {
                    content: "Asistencia: %y",
                    shifts: {
                        x: -60,
                        y: 25
                    },
                    defaultTheme: false
                }
            };
    
            function gd(year, month, day) {
                return new Date(year, month - 1, day).getTime();
            }
    
            $.plot($("#flot-dashboard-chart"), dataset, options);
        });
    </script>

<script>
    //ASISTENCIA SEMANAL
    document.addEventListener("DOMContentLoaded", function () {
        // Gr√°fico de l√≠neas 
        const lineData = {
            labels: ["Lunes", "Martes", "Mi√©rcoles", "Jueves", "Viernes", "S√°bado"],
            datasets: [
                {
                    label: "Virtual",
                    backgroundColor: "rgb(162, 234, 223, 0.5)",
                    borderColor: "rgba(162, 234, 223, 1)",
                    pointBackgroundColor: "rgb(122, 218, 187, 1)",
                    data: [15, 9, 17, 6, 13, 9]
                },
                {
                    label: "Presencial",
                    backgroundColor: "rgba(18, 126, 104, 0.5)",
                    borderColor: "rgba(18, 126, 104, 1)",
                    pointBackgroundColor: "rgba(18, 126, 104, 1)",
                    data: [12, 10, 8, 12, 10, 5]
                }
            ]
        };

        const lineOptions = {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: "top"
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: "Meses"
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: "Valores"
                    }
                }
            }
        };
//ASISTENCIA DIARIA
        const ctxLine = document.getElementById("lineChart").getContext("2d");
        new Chart(ctxLine, {
            type: "line",
            data: lineData,
            options: lineOptions
        });

        // Gr√°fico Pastel
        const doughnutData = {
            labels: ["Puntual", "Tarde", "Falto"],
            datasets: [
                {
                    label: "Dataset",
                    data: [10, 5, 3],
                    backgroundColor: [
                       
                        "rgba(54, 162, 235, 0.5)",
                         "rgba(255, 206, 86, 0.5)",
                        "rgba(255, 99, 132, 0.5)"
                    ],
                    borderColor: [
                       
                        "rgba(54, 162, 235, 1)",
                        "rgba(255, 206, 86, 1)",
                        "rgba(255, 99, 132, 1)"
                    ],
                    borderWidth: 1
                }
            ]
        };

        const doughnutOptions = {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: "top"
                }
            }
        };

        const ctxDoughnut = document.getElementById("doughnutChart2").getContext("2d");
        new Chart(ctxDoughnut, {
            type: "doughnut",
            data: doughnutData,
            options: doughnutOptions
        });
    });

    //CHATBOT

    const chatToggle = document.getElementById("chatToggle");
    const chatBox = document.getElementById("chatBox");
    const closeChat = document.getElementById("closeChat");
    const chatInput = document.getElementById("chatInput");
    const chatBody = document.getElementById("chatBody");

    chatToggle?.addEventListener("click", () => {
        chatBox.style.display = "flex";
    });

    closeChat?.addEventListener("click", () => {
        chatBox.style.display = "none";
    });

    function sendMessage() {
    const message = chatInput.value.trim().toLowerCase();
    if (message !== "") {
        const userMsg = document.createElement("div");
        userMsg.classList.add("user-message");
        userMsg.textContent = chatInput.value;
        chatBody.appendChild(userMsg);

        let response = "Lo siento, no entend√≠ tu mensaje. ¬øPuedes reformularlo o darme m√°s contexto?";

        // √Årbol de decisiones ampliado
        if (message.includes("asistencia")) {
            if (message.includes("reporte")) {
                response = "Puedes generar un reporte desde el m√≥dulo de reportes. ¬øQuieres ver la asistencia diaria, semanal o mensual?";
            } else if (message.includes("registrar")) {
                response = "Para registrar asistencia, ve al panel principal y presiona el bot√≥n 'Registrar'. Aseg√∫rate de estar dentro del horario asignado.";
            } else if (message.includes("historial")) {
                response = "Tu historial de asistencia est√° disponible en la secci√≥n 'Mi Asistencia'. Puedes ver faltas, retrasos y justificaciones.";
            } else {
                response = "¬øDeseas saber c√≥mo registrar, justificar o reportar asistencia?";
            }
        } else if (message.includes("justificaci√≥n") || message.includes("como")|| message.includes("subir")) {
            response = "Las justificaciones se suben en PDF o word en la secci√≥n 'Justificaci√≥n'.";
        } else if (message.includes("rol")) {
            response = "Los roles actuales son: Administrador, Jefe de √Årea y Colaborador. Pr√≥ximamente se podr√° agregar 'Integrante'.";
        } else if (message.includes("chatbot") || message.includes("asisbot")|| message.includes("hola")) {
            response = "Soy AsisBot ü§ñ. Te ayudo con asistencia, reportes, horarios, √°reas, justificaciones y m√°s. ¬øCon qu√© necesitas ayuda?";
        } else if (message.includes("horario")) {
            response = "Consulta tu horario o de alg√∫n colaborador en espec√≠fico. ¬øDime cu√°l deseas saber?";
        } else if (message.includes("√°rea") || message.includes("areas")) {
            response = "Las √°reas registradas son: Administraci√≥n, An√°lisis, Android, Programaci√≥n, Receso, IA, Soporte, Dise√±o y VideoJuegos. ¬øTe interesa ver el personal de alguna?";
        } else if (message.includes("colaborador") && message.includes("faltaron")) {
            response = "Hoy faltaron 3 colaboradores. Marlo Samaniego, Julian Galeon, Martin Bedregal.";
        } else if (message.includes("colaborador")) {
            response = "¬øDeseas ver datos personales o el historial de asistencia de alg√∫n colaborador?";
        } else if (message.includes("contacto") || message.includes("soporte")) {
            response = "Puedes contactar al √°rea de soporte enviando un correo a soporte@sistemadeasistencia.com.";
        } else if (message.includes("trabajando")) {
            response = "Actualmente estan trabajando las √°reas de Programaci√≥n, Dise√±o y Soporte";
        }

        const botMsg = document.createElement("div");
        botMsg.classList.add("bot-message");
        botMsg.textContent = response;
        chatBody.appendChild(botMsg);

        chatInput.value = "";
        chatBody.scrollTop = chatBody.scrollHeight;
    }
}
</script>

</body>
</html>
